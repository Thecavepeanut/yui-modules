<!DOCTYPE HTML>
<html>

<head>
	<title>Node Optimizations Unit Tests</title>
	<meta http-equiv=content-type content="text/html; charset=utf-8">

	<script src="http://yui.yahooapis.com/3.3.0/build/yui/yui-debug.js"></script>
	<script src="gallery-node-optimizations-debug.js"></script>

	<style type="text/css">
	#root { display: none; }
	</style>
</head>

<body class="yui3-skin-sam">

<script type="text/javascript">
YUI({
	filter: 'debug',
	logInclude: { TestRunner: true, Node: true }
}).use('gallery-node-optimizations', 'test', 'console', 'console-filters', 'dd-plugin', function(Y)
{
	Y.one('#display').set('innerHTML',
		Y.Lang.trim(Y.one('#code').get('innerHTML'))
			.replace(/</g, '&lt;')
			.replace(/>/g, '&gt;'));

	Y.Test.Runner.add(new Y.Test.Case(
	{
		name: 'Node optimizations',

		testAncestorByClassName: function()
		{
			var node = Y.one('#a2');
			Y.Assert.areSame(Y.one('#root'), node.getAncestorByClassName('root'));

			var node = Y.one('#b3');
			Y.Assert.areSame(Y.one('#root'), node.getAncestorByClassName('root'));

			var node = Y.one('#b3');
			Y.Assert.areSame(Y.one('#root'), node.ancestor('.root'));

			var node = Y.one('#b3');
			Y.Assert.areSame(Y.one('#root'), node.getAncestorByClassName('ro+t'));
		},

		testAncestorByTagName: function()
		{
			var node = Y.one('#a2');
			Y.Assert.areSame(Y.one('#list'), node.getAncestorByTagName('ul'));

			var node = Y.one('#b3');
			Y.Assert.areSame(Y.one('#b'), node.getAncestorByTagName('li'));

			var node = Y.one('#b3');
			Y.Assert.areSame(Y.one('#b'), node.ancestor('li'));
		},

		testElementsByClassName: function()
		{
			var node = Y.one('#root');

			var list = node.getElementsByClassName('c-child');
			Y.Assert.areSame(0, list.size());

			list = node.getElementsByClassName('a-child');
			Y.Assert.areSame(2, list.size());
			Y.Assert.areSame(Y.one('#a1'), list.item(0));
			Y.Assert.areSame(Y.one('#a2'), list.item(1));

			list = node.getElementsByClassName('b-child');
			Y.Assert.areSame(4, list.size());
			Y.Assert.areSame(Y.one('#b1'), list.item(0));
			Y.Assert.areSame(Y.one('#b2'), list.item(1));
			Y.Assert.areSame(Y.one('#b3'), list.item(2));
			Y.Assert.areSame(Y.one('#b4'), list.item(3));

			list = node.all('.a-child');
			Y.Assert.areSame(2, list.size());
			Y.Assert.areSame(Y.one('#a1'), list.item(0));
			Y.Assert.areSame(Y.one('#a2'), list.item(1));

			list = node.getElementsByClassName('a-.*');
			Y.Assert.areSame(2, list.size());
			Y.Assert.areSame(Y.one('#a1'), list.item(0));
			Y.Assert.areSame(Y.one('#a2'), list.item(1));
		}
	}));

	new Y.Console(
	{
		newestOnTop: false,
		plugins: [ {fn: Y.Plugin.Drag, cfg: {handles: ['.yui3-console-hd']}}, Y.Plugin.ConsoleFilters ]
	})
	.render();

	Y.Test.Runner.run();
});
</script>

<h1><a href="http://yuilibrary.com/gallery/show/node-optimizations">YUI 3 Node Optimizations</a> Unit Tests</h1>

<p><a href="yuidoc">Show me the documentation</a></p>
<p><a href="/yui3-gallery/">Back to project list</a></p>

<p>The unit tests are run on the following DOM structure:</p>
<pre id="display"></pre>

<div id="code">
<div class="root" id="root">
	<ul id="list">
		<li class="a" id="a">
			<div class="a-child" id="a1"></div>
			<div class="a-child" id="a2"></div>
		</li>
		<li class="b" id="b">
			<div class="b-child" id="b1"></div>
			<div class="b-child" id="b2"></div>
			<div class="b-child" id="b3"></div>
			<div class="b-child" id="b4"></div>
		</li>
	</ul>
</div>
</div>

</body>
</html>
