YUI.add("gallery-layout-rows",function(e,t){"use strict";function s(t,n){var r=t;if(i)var s=n.bd.get("offsetHeight");var o=n.root.get("offsetHeight")-n.bd.get("offsetHeight");return n.hd&&(r-=n.hd.get("offsetHeight"),o-=n.hd.get("offsetHeight")),n.ft&&(r-=n.ft.get("offsetHeight"),o-=n.ft.get("offsetHeight")),r-=o,r-=n.bd.vertMarginBorderPadding(),Math.max(r,e.PageLayout.min_module_height)}function o(e,t,n,r,i,s){return s.mbp=i.horizMarginBorderPadding(),Math.max(1,Math.floor(e*t[n][r]/100)-s.mbp)}var n=0<e.UA.ie&&e.UA.ie<8,r=0<e.UA.ie&&e.UA.ie<8,i=0<e.UA.ie&&e.UA.ie<8;e.namespace("PageLayoutRows"),e.PageLayoutRows.collapse_classes={vert_parent_class:e.PageLayout.module_rows_class,horiz_parent_class:e.PageLayout.module_class,collapse_parent_pattern:e.PageLayout.expand_vert_nub_class},e.PageLayoutRows.resize=function(t,i,u,a){var f=t.body_info.outers.size(),l=[],c=[];for(var h=0;h<f;h++){var p=t.body_info.inner_sizes[h].slice(0);l.push(p),c.push(u);var d=0,v=0,m=t.body_info.modules[h],g=m.size();for(var y=0;y<g;y++){var b=m.item(y);b.setStyle("height","auto"),b.hasClass(e.PageLayout.collapsed_horiz_class)?(n&&b.setStyle("display","none"),b.setStyle("width","auto"),n&&b.setStyle("display","block"),p[y]=-b.get("offsetWidth"),c[h]-=b.totalWidth()):p[y]>0&&(d++,v+=p[y])}if(d<g)for(var y=0;y<g;y++)p[y]>0&&(p[y]*=100/v)}var w={};if(t.single_module){var b=t.body_info.modules[0].item(0),E=t._analyzeModule(b);if(E.bd){var S=o(c[0],l,0,0,b,w),x=Math.max(1,S-E.bd.horizMarginBorderPadding());t.fire("beforeResizeModule",{bd:E.bd,height:"auto",width:x}),t._setWidth(E,S),E.root.setStyle("height","auto"),E.bd.setStyle("height","auto")}var T=b.totalHeight();i=T>a?e.PageLayout.FIT_TO_VIEWPORT:e.PageLayout.FIT_TO_CONTENT,t.body_container.removeClass("FIT_TO_[A-Z_]+")}if(i===e.PageLayout.FIT_TO_CONTENT){var N=[];for(var h=0;h<f;h++){t.body_info.outers.item(h).setStyle("height","auto");var m=t.body_info.modules[h],T=0,C=0,k=m.size(),g=k;for(var y=0;y<g;y++){var S=l[h][y],b=m.item(y);if(S<0){var L=!1;if(S==e.PageLayout.unmanaged_size&&r){var E=t._analyzeModule(b);if(E.bd){var A=E.bd.totalWidth();C+=A+b.horizMarginBorderPadding(),L=!0,E.root.setStyle("width",A+"px")}}L||(C+=b.totalWidth()),k--}}var O=0;for(var y=0;y<g;y++){var S=l[h][y],b=m.item(y);if(S<0){if(S==e.PageLayout.unmanaged_size){var E=t._analyzeModule(b);E.bd&&(E.root.setStyle("height","auto"),E.bd.setStyle("height","auto")),T=Math.max(T,b.get("offsetHeight"))}continue}O++;var E=t._analyzeModule(b);if(E.bd){var S=o(c[h],l,h,y,b,w);C+=S+w.mbp,O==k&&(S+=u-C);var x=Math.max(1,S-E.bd.horizMarginBorderPadding());t.fire("beforeResizeModule",{bd:E.bd,height:"auto",width:x}),t._setWidth(E,S),E.root.setStyle("height","auto"),E.bd.setStyle("height","auto")}T=Math.max(T,b.get("offsetHeight"))}N.push(T)}}else{var N=t.body_info.outer_sizes.slice(0),d=0,v=0;for(var h=0;h<f;h++){var M=t.body_info.outers.item(h),_=M.hasClass(e.PageLayout.collapsed_vert_class);_||N[h]<0?(N[h]=0,_&&M.setStyle("height","auto"),a-=M.one("*").totalHeight(),a-=M.vertMarginBorderPadding()):(d++,v+=N[h])}if(d<f)for(var h=0;h<f;h++)N[h]*=100/v}for(var h=0;h<f;h++){if(i===e.PageLayout.FIT_TO_CONTENT)var T=N[h];else{if(N[h]===0){var b=t.body_info.modules[h].item(0),E=t._analyzeModule(b);if(E.bd){var D=E.bd.insideHeight(),S=o(c[h],l,h,0,b,w),x=Math.max(1,S-E.bd.horizMarginBorderPadding());t.fire("beforeResizeModule",{bd:E.bd,height:D,width:x}),t._setWidth(E,S),t.fire("afterResizeModule",{bd:E.bd,height:D,width:x})}continue}var T=Math.max(1,Math.floor(a*N[h]/100)-t.body_info.outers.item(h).vertMarginBorderPadding())}t.body_info.outers.item(h).setStyle("height",T+"px");var m=t.body_info.modules[h],C=0,k=m.size(),g=k;for(var y=0;y<g;y++){var S=l[h][y],b=m.item(y);if(S<0){var L=!1;if(S==e.PageLayout.unmanaged_size){var E=t._analyzeModule(b);if(E.bd){var D=s(T,E),x=E.bd.insideWidth();t.fire("beforeResizeModule",{bd:E.bd,height:D,width:x}),E.bd.setStyle("height",D+"px");if(r){var A=E.bd.totalWidth();C+=A+b.horizMarginBorderPadding(),L=!0,E.root.setStyle("width",A+"px")}t.fire("afterResizeModule",{bd:E.bd,height:D,width:x})}}else b.setStyle("height",Math.max(1,T-b.vertMarginBorderPadding())+"px");L||(C+=b.totalWidth()),k--}}var O=0;for(var y=0;y<g;y++){if(l[h][y]<0)continue;O++;var b=m.item(y),E=t._analyzeModule(b);if(E.bd){var D=s(T,E),S=o(c[h],l,h,y,b,w);C+=S+w.mbp,O==k&&(S+=u-C);var x=Math.max(1,S-E.bd.horizMarginBorderPadding());i===e.PageLayout.FIT_TO_VIEWPORT&&(t.fire("beforeResizeModule",{bd:E.bd,height:D,width:x}),t._setWidth(E,S)),E.bd.setStyle("height",D+"px"),t.fire("afterResizeModule",{bd:E.bd,height:D,width:x})}}}}},"@VERSION@",{requires:["gallery-layout"]});
