YUI.add("gallery-matrix-credits",function(b){function i(m){this.timer={};this.bkgd_on=[];i.superclass.constructor.call(this,m);}i.NAME="matrixcredits";i.ATTRS={textSequence:{value:[],validator:b.Lang.isArray},introDelay:{value:5000,validator:b.Lang.isNumber},framePause:{value:2000,validator:b.Lang.isNumber},restartDelay:{value:5000,validator:b.Lang.isNumber},cursor:{value:"block",validator:function(m){return m=="none"||m=="block"||m=="char";}},maxPhaseCount:{value:20,validator:b.Lang.isNumber},charRange:{value:["!","~"],validator:function(m){return(b.Lang.isArray(m)&&m.length==2&&m[0].length==1&&m[1].length==1&&m[0]<m[1]);}},backgroundConfig:{writeOnce:true}};var e={cursor:30};var d=b.Plugin.MatrixBackground.rnd;var j=b.Plugin.MatrixBackground.startTimer;var h=b.Plugin.MatrixBackground.stopTimer;function l(){var o=this.get("textSequence");var n=o[this.frame_index];var m=(this.frame_index==o.length-1)?"restartDelay":"framePause";b.later(n.pause||this.get(m),this,a);}function a(){var p=this.get("textSequence");this.frame_index++;if(this.frame_index>=p.length){this.frame_index=0;}var o=p[this.frame_index];var n=b.reduce(o.intro||[],"",function(r,q){return r+"<p>"+(q||"&nbsp;")+"</p>";});var m=b.reduce(o.lines||[],"",function(t,q){t+="<p><span>x";for(var r=0;r<q.length;r++){t+="&nbsp;";}return t+"x</span></p>";});this.frame.setContent(n+m);this.frame_top=Math.floor((this.get("height")-this.frame.totalHeight())/2);this.frame.setStyle("top",this.frame_top+"px");if(o.lines){this.frame_lines=this.frame.all("span");this.frame_line_index={row:0,col:-1};this.cursor.removeClass("hidden");this.cursor_top=this.frame_top-this.frame.totalHeight();j.call(this,"cursor");this.spin_handle=this.bkgd.on("spin",f,this);}else{l.call(this);}}function g(){this.frame_line_index.col++;if(parseInt(this.cursor.getStyle("left"),10)>this.get("width")){this.frame_line_index.col=0;this.frame_line_index.row++;if(this.frame_line_index.row>=this.frame_lines.size()){this.cursor.addClass("hidden");this.cursor.setStyles({top:0,left:0});h.call(this,"cursor");l.call(this);return;}}this.cursor.setStyles({top:(this.cursor_top+this.frame_lines.item(this.frame_line_index.row).get("offsetTop"))+"px",left:(this.cursor_width*this.frame_line_index.col)+"px"});}function f(){if(this.timer.cursor&&this.get("cursor")=="char"){var m=b.Plugin.MatrixBackground.getCharacterRange.call(this.bkgd);this.cursor.set("innerHTML",String.fromCharCode(d(m[0],m[1]+1)));}}function k(){var m=this.get("cursor");if(m=="block"){this.cursor.set("innerHTML","\u2588");}else{this.cursor.set("innerHTML","&nbsp;");}this.cursor_width=this.cursor.get("offsetWidth");}function c(){this.set("width",b.DOM.winWidth());this.set("height",b.DOM.winHeight());}b.extend(i,b.Widget,{initializer:function(m){if(this.get("boundingBox").ancestor()==b.one("body")){c.call(this);b.on("windowresize",c,this);}this.on("cursor",g);},destructor:function(){h.call(this,"cursor");},syncUI:function(){var m=this.get("boundingBox");m.plug(b.Plugin.MatrixBackground,this.get("backgroundConfig"));this.bkgd=m.matrix;this.frame=b.Node.create('<div class="frame"></div>');this.get("contentBox").append(this.frame);this.cursor=b.Node.create('<span class="cursor hidden"></span>');this.get("contentBox").append(this.cursor);k.call(this);this.after("cursorChange",k);this.frame_index=-1;b.later(this.get("introDelay"),this,a);}});b.MatrixCredits=i;},"@VERSION@",{requires:["widget","gallery-matrix-background","gallery-funcprog"],skinnable:true});