YUI.add("gallery-layout-rows",function(d){var c=(0<d.UA.ie&&d.UA.ie<8),f=(0<d.UA.ie&&d.UA.ie<8),b=(0<d.UA.ie&&d.UA.ie<8);d.namespace("PageLayoutRows");d.PageLayoutRows.collapse_classes={vert_parent_class:d.PageLayout.module_rows_class,horiz_parent_class:d.PageLayout.module_class,collapse_parent_pattern:d.PageLayout.expand_vert_nub_class};function e(k,j){var l=k;if(b){var i=j.bd.get("offsetHeight");}var g=j.root.get("offsetHeight")-j.bd.get("offsetHeight");if(j.hd){l-=j.hd.get("offsetHeight");g-=j.hd.get("offsetHeight");}if(j.ft){l-=j.ft.get("offsetHeight");g-=j.ft.get("offsetHeight");}l-=g;l-=j.bd.vertMarginBorderPadding();return Math.max(l,d.PageLayout.min_module_height);}function a(g,l,j,k,i,h){h.mbp=i.horizMarginBorderPadding();return Math.max(1,Math.floor(g*l[j][k]/100)-h.mbp);}d.PageLayoutRows.resize=function(D){if(!D.body_container){return;}var C=D.get("mode");D.body_container.setStyle("overflowX",C===d.PageLayout.FIT_TO_CONTENT?"auto":"hidden");D.body_container.setStyle("overflowY",C===d.PageLayout.FIT_TO_CONTENT?"scroll":"hidden");var P={w:D.body_container.get("winWidth"),h:D.body_container.get("winHeight")};var M=arguments[0]&&arguments[0].type=="resize";if(M&&(P.w===D.viewport.w&&P.h===D.viewport.h)){return;}D.viewport=P;D.fire("beforeReflow");var A=D.get("minWidth")*d.Node.emToPx();var O=Math.max(D.viewport.w,A);if(D.header_container){D.header_container.setStyle("width",O+"px");}D.body_container.setStyle("width",(O-D.body_horiz_mbp)+"px");if(D.footer_container){D.footer_container.setStyle("width",D.get("stickyFooter")?O+"px":"auto");}O=D.body_container.get("clientWidth")-D.body_horiz_mbp;D.viewport.bcw=D.body_container.get("clientWidth");var L=D.viewport.h;var g=D.get("minHeight")*d.Node.emToPx();if(C===d.PageLayout.FIT_TO_VIEWPORT&&L<g){L=g;d.one(document.documentElement).setStyle("overflowY","auto");}else{if(!window.console||!window.console.layout_force_viewport_scrollbars){d.one(document.documentElement).setStyle("overflowY","hidden");}}if(D.header_container){L-=D.header_container.totalHeight();}if(D.footer_container&&(C===d.PageLayout.FIT_TO_VIEWPORT||D.get("stickyFooter"))){L-=D.footer_container.totalHeight();}if(C===d.PageLayout.FIT_TO_VIEWPORT){var t=L-D.body_vert_mbp;}else{if(L<0){L=10+D.body_vert_mbp;}}D.body_container.setStyle("height",(L-D.body_vert_mbp)+"px");var z=D.body_rows.rows.size();var m=[],K=[];for(var J=0;J<z;J++){var v=D.body_rows.col_widths[J].slice(0);m.push(v);K.push(O);var N=0,n=0;var Q=D.body_rows.modules[J];var s=Q.size();for(var I=0;I<s;I++){var l=Q.item(I);l.setStyle("height","auto");if(l.hasClass(d.PageLayout.collapsed_horiz_class)){if(c){l.setStyle("display","none");}l.setStyle("width","auto");if(c){l.setStyle("display","block");}v[I]=-l.get("offsetWidth");K[J]-=l.totalWidth();}else{if(v[I]>0){N++;n+=v[I];}}}if(N<s){for(var I=0;I<s;I++){if(v[I]>0){v[I]*=(100/n);}}}}var F={};if(C===d.PageLayout.FIT_TO_CONTENT){var q=[];for(var J=0;J<z;J++){D.body_rows.rows.item(J).setStyle("height","auto");var Q=D.body_rows.modules[J];var L=0;var E=0;var B=Q.size();var s=B;for(var I=0;I<s;I++){var y=m[J][I];var l=Q.item(I);if(y<0){var R=false;if(y==d.PageLayout.unmanaged_size&&f){var p=D._analyzeModule(l);if(p.bd){var H=p.bd.totalWidth();E+=H+l.horizMarginBorderPadding();R=true;p.root.setStyle("width",H+"px");}}if(!R){E+=l.totalWidth();}B--;}}var G=0;for(var I=0;I<s;I++){var y=m[J][I];var l=Q.item(I);if(y<0){if(y==d.PageLayout.unmanaged_size){var p=D._analyzeModule(l);if(p.bd){p.root.setStyle("height","auto");p.bd.setStyle("height","auto");}L=Math.max(L,l.get("offsetHeight"));}continue;}G++;var p=D._analyzeModule(l);if(p.bd){var y=a(K[J],m,J,I,l,F);E+=y+F.mbp;if(G==B){y+=O-E;}var x=Math.max(1,y-p.bd.horizMarginBorderPadding());D.fire("beforeResizeModule",p.bd,"auto",x);D._setWidth(p,y);p.root.setStyle("height","auto");p.bd.setStyle("height","auto");}L=Math.max(L,l.get("offsetHeight"));}q.push(L);}}else{var q=D.body_rows.row_heights.slice(0);var N=0,n=0;for(var J=0;J<z;J++){var r=D.body_rows.rows.item(J);var o=r.hasClass(d.PageLayout.collapsed_vert_class);if(o||q[J]<0){q[J]=0;if(o){r.setStyle("height","auto");}t-=r.one("*").totalHeight();t-=r.vertMarginBorderPadding();}else{N++;n+=q[J];}}if(N<z){for(var J=0;J<z;J++){q[J]*=(100/n);}}}for(var J=0;J<z;J++){if(C===d.PageLayout.FIT_TO_CONTENT){var L=q[J];}else{if(q[J]===0){var l=D.body_rows.modules[J].item(0);var p=D._analyzeModule(l);if(p.bd){var u=p.bd.insideHeight();var y=a(K[J],m,J,0,l,F);var x=Math.max(1,y-p.bd.horizMarginBorderPadding());D.fire("beforeResizeModule",p.bd,u,x);D._setWidth(p,y);D.fire("afterResizeModule",p.bd,u,x);}continue;}var L=Math.max(1,Math.floor(t*q[J]/100)-D.body_rows.rows.item(J).vertMarginBorderPadding());}D.body_rows.rows.item(J).setStyle("height",L+"px");var Q=D.body_rows.modules[J];var E=0;var B=Q.size();var s=B;for(var I=0;I<s;I++){var y=m[J][I];var l=Q.item(I);if(y<0){var R=false;if(y==d.PageLayout.unmanaged_size){var p=D._analyzeModule(l);if(p.bd){var u=e(L,p);var x=p.bd.insideWidth();D.fire("beforeResizeModule",p.bd,u,x);p.bd.setStyle("height",u+"px");if(f){var H=p.bd.totalWidth();E+=H+l.horizMarginBorderPadding();R=true;p.root.setStyle("width",H+"px");}D.fire("afterResizeModule",p.bd,u,x);}}else{l.setStyle("height",Math.max(1,L-l.vertMarginBorderPadding())+"px");}if(!R){E+=l.totalWidth();}B--;}}var G=0;for(var I=0;I<s;I++){if(m[J][I]<0){continue;}G++;var l=Q.item(I);var p=D._analyzeModule(l);if(p.bd){var u=e(L,p);var y=a(K[J],m,J,I,l,F);E+=y+F.mbp;if(G==B){y+=O-E;}var x=Math.max(1,y-p.bd.horizMarginBorderPadding());if(C===d.PageLayout.FIT_TO_VIEWPORT){D.fire("beforeResizeModule",p.bd,u,x);D._setWidth(p,y);}p.bd.setStyle("height",u+"px");D.fire("afterResizeModule",p.bd,u,x);}}}D.body_container.setStyle("visibility","visible");if(D.footer_container){D.footer_container.setStyle("visibility","visible");}d.Lang.later(100,D,D._checkViewportSize);};},"@VERSION@",{requires:["gallery-layout","gallery-dimensions","gallery-node-optimizations"]});