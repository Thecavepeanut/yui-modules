YUI.add("gallery-layout-cols",function(b){var d=(0<b.UA.ie&&b.UA.ie<8);b.namespace("PageLayoutCols");b.PageLayoutCols.collapse_classes={vert_parent_class:b.PageLayout.module_class,horiz_parent_class:b.PageLayout.module_cols_class,collapse_parent_pattern:"("+b.PageLayout.expand_left_nub_class+"|"+b.PageLayout.expand_right_nub_class+")"};function c(f,e){var g=f;if(e.hd){g-=e.hd.get("offsetHeight");}if(e.ft){g-=e.ft.get("offsetHeight");}g-=e.bd.vertMarginBorderPadding();return Math.max(g,b.PageLayout.min_module_height);}function a(j,i,h,g,f,e){e.mbp=f.vertMarginBorderPadding();return Math.max(1,Math.floor(j*i[h][g]/100)-e.mbp);}b.PageLayoutCols.resize=function(g){if(!g.body_container){return;}var n=g.get("mode");g.body_container.setStyle("overflowX",n===b.PageLayout.FIT_TO_CONTENT?"auto":"hidden");g.body_container.setStyle("overflowY",n===b.PageLayout.FIT_TO_CONTENT?"scroll":"hidden");var E={w:g.body_container.get("winWidth"),h:g.body_container.get("winHeight")};var R=arguments[0]&&arguments[0].type=="resize";if(R&&(E.w===the_body_cols.viewport.w&&E.h===the_body_cols.viewport.h)){return;}the_body_cols.viewport=E;g.fire("beforeReflow");var V=g.get("minWidth")*b.Node.emToPx();var I=Math.max(the_body_cols.viewport.w,V);if(g.header_container){g.header_container.setStyle("width",I+"px");}g.body_container.setStyle("width",(I-g.body_horiz_mbp)+"px");if(g.footer_container){g.footer_container.setStyle("width",g.get("stickyFooter")?I+"px":"auto");}I=g.body_container.get("clientWidth")-g.body_horiz_mbp;the_body_cols.viewport.bcw=g.body_container.get("clientWidth");var P=the_body_cols.viewport.h;var t=g.get("minHeight")*b.Node.emToPx();if(n===b.PageLayout.FIT_TO_VIEWPORT&&P<t){P=t;b.one(document.documentElement).setStyle("overflowY","auto");}else{if(!window.console||!window.console.layout_force_viewport_scrollbars){b.one(document.documentElement).setStyle("overflowY","hidden");}}if(g.header_container){P-=g.header_container.get("offsetHeight");}if(g.footer_container&&(n===b.PageLayout.FIT_TO_VIEWPORT||g.get("stickyFooter"))){P-=g.footer_container.get("offsetHeight");}if(n===b.PageLayout.FIT_TO_VIEWPORT){var o=P-g.body_vert_mbp;}else{if(P<0){P=10+g.body_vert_mbp;}}g.body_container.setStyle("height",(P-g.body_vert_mbp)+"px");var T=the_body_cols.cols.size();if(n===b.PageLayout.FIT_TO_VIEWPORT){var G=[],x=[];for(var N=0;N<T;N++){var J=the_body_cols.row_heights[N].slice(0);G.push(J);x.push(o);var Q=0,r=0;var u=the_body_cols.modules[N];var H=u.size();for(var M=0;M<H;M++){var f=u.item(M);if(f.hasClass(b.PageLayout.collapsed_vert_class)){f.setStyle("height","auto");J[M]=-f.get("offsetHeight");x[N]-=f.totalHeight();}else{if(J[M]>0){Q++;r+=J[M];}}}if(Q<H){for(var M=0;M<H;M++){if(J[M]>0){J[M]*=(100/r);}}}}}var C={};var A=the_body_cols.col_widths.slice(0);var Q=0,r=0;for(var N=0;N<T;N++){var l=the_body_cols.cols[N];var U=l.hasClass(b.PageLayout.collapsed_horiz_class);var u=the_body_cols.modules[N];if(U||A[N]<0){A[N]=0;if(U){l.setStyle("width","auto");u[0].setStyle("width","auto");}else{if(d){var s=g._analyzeModule(u[0]);if(s.bd){var q=s.bd.totalWidth()+u.item(M).horizMarginBorderPadding();s.root.setStyle("width",q+"px");l.setStyle("width",q+"px");}}}I-=l.totalWidth();}else{Q++;r+=A[N];if(u.size()==1){u[0].setStyle("height","auto");}}}if(Q<T){for(var N=0;N<T;N++){A[N]*=(100/r);}}var O=0,K=0,y=[];for(var N=0;N<T;N++){if(A[N]==0){var f=the_body_cols.modules[N].item(0);var s=g._analyzeModule(f);if(n===b.PageLayout.FIT_TO_VIEWPORT){var P=a(x[N],G,N,0,f,C);f.setStyle("height",P+"px");if(s.bd){var v=c(P,s);var z=s.bd.insideWidth();g.fire("beforeResizeModule",s.bd,v,z);s.bd.setStyle("height",v+"px");g.fire("afterResizeModule",s.bd,v,z);}}else{if(s.bd){g.fire("beforeResizeModule",s.bd,"auto","auto");s.root.setStyle("height","auto");s.bd.setStyle("height","auto");if(g.get("matchColumnHeights")){y.push([[s.bd,s.bd.insideWidth()]]);}else{g.fire("afterResizeModule",s.bd,s.bd.insideHeight(),s.bd.insideWidth());}}}continue;}K++;var D=Math.max(1,Math.floor(I*A[N]/100));O+=D;if(K==Q){D+=I-O;}D=Math.max(1,D-the_body_cols.cols.item(N).horizMarginBorderPadding());the_body_cols.cols.item(N).setStyle("width",D+"px");D=Math.max(1,D-the_body_cols.modules[0][0].horizMarginBorderPadding());var u=the_body_cols.modules[N];if(n===b.PageLayout.FIT_TO_VIEWPORT){var e=0;var F=u.size();var H=F;for(var M=0;M<H;M++){var P=G[N][M];if(P<0){e+=u.item(M).totalHeight();F--;}}var L=0;for(var M=0;M<H;M++){var f=u.item(M);var s=g._analyzeModule(f);if(G[N][M]<0){var v=s.bd.insideHeight();var z=D-s.root.horizMarginBorderPadding()-s.bd.horizMarginBorderPadding();g.fire("beforeResizeModule",s.bd,v,z);f.setStyle("width",D+"px");g.fire("afterResizeModule",s.bd,v,z);continue;}L++;if(s.bd){var P=a(x[N],G,N,M,f,C);var v=c(P,s);e+=P+C.mbp;if(L==F){v+=o-e;}var z=Math.max(1,D-s.bd.horizMarginBorderPadding());g.fire("beforeResizeModule",s.bd,v,z);g._setWidth(s,D);s.bd.setStyle("height",v+"px");g.fire("afterResizeModule",s.bd,v,z);}}}else{y.push([]);var H=u.size();for(var M=0;M<H;M++){var s=g._analyzeModule(u.item(M));if(s.bd){var z=Math.max(1,D-s.bd.horizMarginBorderPadding());g.fire("beforeResizeModule",s.bd,"auto",z);g._setWidth(s,D);s.root.setStyle("height","auto");s.bd.setStyle("height","auto");if(g.get("matchColumnHeights")){y[N].push([s.bd,z]);}else{g.fire("afterResizeModule",s.bd,s.bd.insideHeight(),z);}}}}}if(n===b.PageLayout.FIT_TO_CONTENT&&g.get("matchColumnHeights")){var P=0;for(var N=0;N<T;N++){P=Math.max(P,the_body_cols.cols.item(N).get("offsetHeight"));}for(var N=0;N<T;N++){var u=the_body_cols.modules[N],H=u.size(),f=null,z=0;for(var M=H-1;M>=0;M--){var p=u.item(M);if(H==1||(!f&&!p.hasClass(b.PageLayout.collapsed_vert_class)&&the_body_cols.row_heights[N][M]>0)){f=p;z=y[N][M][1];}else{var S=y[N][M][0];g.fire("afterResizeModule",S,S.insideHeight(),y[N][M][1]);}}if(f){var B=P-the_body_cols.cols.item(N).get("offsetHeight");if(B>0&&f.parentNode.hasClass(b.PageLayout.collapsed_horiz_class)){f.setStyle("height",(f.insideHeight()+B)+"px");}else{var s=g._analyzeModule(f);
if(s.bd){var v=s.bd.insideHeight()+B;f.setStyle("height","auto");s.bd.setStyle("height",v+"px");g.fire("afterResizeModule",s.bd,v,z);}}}}}g.body_container.setStyle("visibility","visible");if(g.footer_container){g.footer_container.setStyle("visibility","visible");}b.Lang.later(100,g,g._checkViewportSize);};},"@VERSION@",{requires:["gallery-layout","gallery-dimensions","gallery-node-optimizations"]});