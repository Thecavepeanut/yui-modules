YUI.add("gallery-input-calendar-sync",function(e){function d(f){d.superclass.constructor.call(this,f);}d.NAME="InputCalendarSyncPlugin";d.NS="calendarSync";d.ATTRS={calendar:{validator:function(f){return(f instanceof e.Calendar);}},allowBlank:{value:true,validator:e.Lang.isBoolean}};function c(){if(this.ignore_value_change){return;}var h=this.get("host"),j=this.get("calendar"),i=e.Lang.trim(h.get("value"));if(i.length>0){try{this.ignore_selection_change=true;var f=e.DateTimeUtils.normalize(e.DateTimeUtils.parseDate(i),{hour:0,minute:0});j.deselectDates();j.selectDates(f.date);j.set("date",f.date);}catch(g){}finally{this.ignore_selection_change=false;}b.call(this);}else{if(!this.get("allowBlank")){b.call(this);}else{j.deselectDates();}}}function a(){if(!this.ignore_selection_change){this.get("host").focus();b.call(this);}}function b(){this.ignore_value_change=true;var f=this.get("calendar").get("selectedDates")[0];this.get("host").set("value",e.DateTimeUtils.formatDate(f));this.ignore_value_change=false;}e.extend(d,e.Plugin.Base,{initializer:function(f){var g=this.get("host");this.handle=[g.on("change",c,this),g.on("valueSet",c,this),this.get("calendar").on("selectionChange",a,this)];this.get("calendar").set("selectionMode","single");c.call(this);},destructor:function(){this.change_handle.detach();this.set_handle.detach();this.cal_handle.detach();}});e.namespace("Plugin");e.Plugin.InputCalendarSync=d;},"@VERSION@",{requires:["node-pluginhost","plugin","gallery-datetime-utils","calendar","gallery-node-event-set"]});