YUI.add("gallery-io-multiresponse",function(a){var k=a.config.win,r=a.config.doc,b=(r.documentMode&&r.documentMode>=8),e=decodeURIComponent;function h(x,w){var y=[],d=w.split("="),v,u;for(v=0,u=d.length-1;v<u;v++){y[v]=r.createElement("input");y[v].type="hidden";y[v].name=e(d[v].substring(d[v].lastIndexOf("&")+1));y[v].value=(v+1===u)?e(d[v+1]):e(d[v+1].substring(0,(d[v+1].lastIndexOf("&"))));x.appendChild(y[v]);}return y;}function j(v,w){var u,d;for(u=0,d=w.length;u<d;u++){v.removeChild(w[u]);}}function f(u,v,d){u.setAttribute("action",d);u.setAttribute("method","POST");u.setAttribute("target","io-multi-response-"+v);u.setAttribute(a.UA.ie&&!b?"encoding":"enctype","multipart/form-data");}function c(u,d){var v;for(v in d){if(d.hasOwnProperty(v)){if(d[v]){u.setAttribute(v,u[v]);}else{u.removeAttribute(v);}}}}function o(d,u){a.io._timeout[d.id]=k.setTimeout(function(){var v={id:d.id,status:"timeout"};a.io.end(v,u);},u.timeout);}function l(d){k.clearTimeout(a.io._timeout[d]);delete a.io._timeout[d];}function i(u,d){if(!d.debug){a.Event.purgeElement("#io-multi-response-"+u,false);a.one("body").removeChild(a.one("#io-multi-response-"+u));if(d.form.id.indexOf("io-multi-response-form-")===0){a.one("body").removeChild(a.one("#"+d.form.id));}}}function g(d,u){if(u.timeout){l(d.id);}a.io.end(d,u);k.setTimeout(function(){i(d.id,u);},0);}function q(u,v){var d=a.Node.create('<iframe id="io-multi-response-'+u.id+'" name="io-multi-response-'+u.id+'" />');d._node.style.position="absolute";d._node.style.top="-1000px";d._node.style.left="-1000px";a.one("body").appendChild(d);a.on("load",function(){g(u,v);},"#io-multi-response-"+u.id);}function p(v){var u=a.guid("io-multi-response-form-"),d=a.Node.create('<form id="'+u+'" name="'+u+'" />');d._node.style.position="absolute";d._node.style.top="-1000px";d._node.style.left="-1000px";a.one("body").appendChild(d);return u;}function t(x,v,y){var w=(typeof y.form.id==="string")?r.getElementById(y.form.id):y.form.id,u,d={action:w.getAttribute("action"),target:w.getAttribute("target")};f(w,x.id,v);if(y.data){u=h(w,y.data);}if(y.timeout){o(x,y);}w.submit();a.io.start(x.id,y);if(y.data){j(w,u);}c(w,d);return{id:x.id,abort:function(){var z={id:x.id,status:"abort"};if(a.one("#io-multi-response-"+x.id)){i(x.id,y);a.io.end(z,y);}else{return false;}},isInProgress:function(){return a.one("#io-multi-response-"+x.id)?true:false;}};}function m(w,x){var v=new a.EventTarget().publish("transaction:"+w),d=x.arguments,u=x.context||a;if(d){v.on(x.on[w],u,d);}else{v.on(x.on[w],u);}return v;}var n=a.io.upload;a.io.upload=function(u,d,v){if(!v.multiresponse){return n.apply(this,arguments);}YUI.Env.io_multi_response_callback[u.id]=function(w){if(!w){return;}l(u.id);o(u,v);if(v.on&&v.on.response){m("response",v).fire(u.id,w);}};v.data=(v.data||"")+"callback="+encodeURIComponent("YUI.Env.io_multi_response_callback["+u.id+"]");if(v.form&&!v.form.id){delete v.form;}q(u,v);return t(u,d,v);};YUI.Env.io_multi_response_callback=[];var s=a.io;a.io=function(u,v,d){if(v.multiresponse&&!v.form){v.form={id:p(v),upload:true};}else{if(v.multiresponse&&!v.form.upload){v.form.upload=true;}}s.call(this,u,v,d);};a.mix(a.io,s);},"@VERSION@",{requires:["io-upload-iframe"]});